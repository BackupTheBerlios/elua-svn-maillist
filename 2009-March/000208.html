<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Elua-svn] r252 - trunk/doc/en
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/elua-svn/2009-March/index.html" >
   <LINK REL="made" HREF="mailto:elua-svn%40lists.berlios.de?Subject=Re%3A%20%5BElua-svn%5D%20r252%20-%20trunk/doc/en&In-Reply-To=%3C200903111358.n2BDwLnH030370%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000207.html">
   <LINK REL="Next"  HREF="000209.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Elua-svn] r252 - trunk/doc/en</H1>
    <B>bogdanm at BerliOS</B> 
    <A HREF="mailto:elua-svn%40lists.berlios.de?Subject=Re%3A%20%5BElua-svn%5D%20r252%20-%20trunk/doc/en&In-Reply-To=%3C200903111358.n2BDwLnH030370%40sheep.berlios.de%3E"
       TITLE="[Elua-svn] r252 - trunk/doc/en">bogdanm at mail.berlios.de
       </A><BR>
    <I>Wed Mar 11 14:58:21 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000207.html">[Elua-svn] r251 - in trunk: inc/newlib src src/newlib	src/platform/i386 src/platform/lm3s
</A></li>
        <LI>Next message: <A HREF="000209.html">[Elua-svn] r253 - trunk/doc/en
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#208">[ date ]</a>
              <a href="thread.html#208">[ thread ]</a>
              <a href="subject.html#208">[ subject ]</a>
              <a href="author.html#208">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: bogdanm
Date: 2009-03-11 14:58:20 +0100 (Wed, 11 Mar 2009)
New Revision: 252

Modified:
   trunk/doc/en/building.html
   trunk/doc/en/faq.html
   trunk/doc/en/status.html
Log:
added a page about LTR in the docs; other pages updated with links to this new LTR patch

Modified: trunk/doc/en/building.html
===================================================================
--- trunk/doc/en/building.html	2009-03-10 20:39:51 UTC (rev 251)
+++ trunk/doc/en/building.html	2009-03-11 13:58:20 UTC (rev 252)
@@ -150,7 +150,17 @@
 module from &lt;b&gt;eLua&lt;/b&gt;.&lt;/p&gt;
 &lt;p&gt;The modules included in the build are specified by the
 LUA_PLATFORM_LIBS_ROM macro. An example is given below: &lt;/p&gt;
-&lt;pre&gt;&lt;code&gt;#define LUA_PLATFORM_LIBS_ROM\&lt;br&gt; _ROM( AUXLIB_PIO, luaopen_pio, pio_map )\&lt;br&gt; _ROM( AUXLIB_TMR, luaopen_tmr, tmr_map )\&lt;br&gt; _ROM( AUXLIB_PD, luaopen_pd, pd_map )\&lt;br&gt; _ROM( AUXLIB_UART, luaopen_uart, uart_map )\&lt;br&gt; _ROM( AUXLIB_TERM, luaopen_term, term_map )\&lt;br&gt; _ROM( AUXLIB_PWM, luaopen_pwm, pwm_map )\&lt;br&gt; _ROM( AUXLIB_PACK, luaopen_pack, pack_map )\&lt;br&gt; _ROM( AUXLIB_BIT, luaopen_bit, bit_map )\&lt;br&gt; _ROM( AUXLIB_CPU, luaopen_cpu, cpu_map )\&lt;br&gt; _ROM( LUA_MATHLIBNAME, luaopen_math, math_map )&lt;/code&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;code&gt;#define LUA_PLATFORM_LIBS_ROM\
+  _ROM( AUXLIB_PIO, luaopen_pio, pio_map )\
+  _ROM( AUXLIB_TMR, luaopen_tmr, tmr_map )\
+  _ROM( AUXLIB_PD, luaopen_pd, pd_map )\
+  _ROM( AUXLIB_UART, luaopen_uart, uart_map )\
+  _ROM( AUXLIB_TERM, luaopen_term, term_map )\
+  _ROM( AUXLIB_PWM, luaopen_pwm, pwm_map )\
+  _ROM( AUXLIB_PACK, luaopen_pack, pack_map )\
+  _ROM( AUXLIB_BIT, luaopen_bit, bit_map )\
+  _ROM( AUXLIB_CPU, luaopen_cpu, cpu_map )\
+   ROM( LUA_MATHLIBNAME, luaopen_math, math_map )&lt;/code&gt;&lt;/pre&gt;
 &lt;p&gt;Each module is defined by a &lt;b&gt;_ROM( module_name,
 module_init_function, module_map_array )&lt;/b&gt; macro, where:
 &lt;/p&gt;
@@ -165,7 +175,7 @@
 &lt;p&gt;Please note that this notation is specific to LTR (the &lt;b&gt;L&lt;/b&gt;ua
 &lt;b&gt;T&lt;/b&gt;iny &lt;b&gt;R&lt;/b&gt;AM patch) and it's not the
 only way to specify the list of modules included in the build (although
-it is the most common one). Check the &lt;a href=&quot;&quot;&gt;##LTR
+it is the most common one). Check the &lt;a href=&quot;arch_ltr.html#config&quot;&gt;LTR
 section&lt;/a&gt; for more information about LTR.&lt;/p&gt;
 &lt;p&gt;For the full list of modules that can be enabled or disabled
 via &lt;i&gt;platform_conf.h&lt;/i&gt; check &lt;a href=&quot;&quot;&gt;##the
@@ -304,7 +314,7 @@
 this specifies the name of the toolchain used to build the image. See &lt;a href=&quot;toolchains.html#configuration&quot;&gt;this link&lt;/a&gt; for
 details.&lt;/li&gt;
 &lt;li&gt;&lt;b&gt;optram=0 | 1&lt;/b&gt;: enables of disables the
-LTR patch, see the &lt;a href=&quot;&quot;&gt;##LTR documentation&lt;/a&gt;
+LTR patch, see the &lt;a href=&quot;arch_ltr.html&quot;&gt;LTR documentation&lt;/a&gt;
 for more details. The default is 1, which enables the LTR patch.&lt;/li&gt;
 &lt;li&gt;&lt;b&gt;prog&lt;/b&gt;: by default, the above 'scons'
 command will build only the 'elf' (executable) file. Specify &quot;prog&quot; to
@@ -347,4 +357,4 @@
 &quot;generic&quot; ARM GCC toolchain, usually the one built by following
 the tutorials from this site&lt;/p&gt;
 .
-&lt;/body&gt;&lt;/html&gt;
\ No newline at end of file
+&lt;/body&gt;&lt;/html&gt;

Modified: trunk/doc/en/faq.html
===================================================================
--- trunk/doc/en/faq.html	2009-03-10 20:39:51 UTC (rev 251)
+++ trunk/doc/en/faq.html	2009-03-11 13:58:20 UTC (rev 252)
@@ -23,6 +23,8 @@
   &lt;li&gt;&lt;a href=&quot;faq.html#bytecode&quot;&gt;I know that Lua can be compiled to bytecode, so I compiled one of the eLua examples with luac and tried to run it on 
   my eLua board, but it didn't work. Is this a bug in eLua?&lt;/li&gt;
   &lt;li&gt;&lt;a href=&quot;faq.html#outofmemory&quot;&gt;I get &quot;out of memory&quot; errors when I run my Lua programs, what should I do?&lt;/li&gt;
+  &lt;li&gt;&lt;a href=&quot;faq.html#rotables&quot;&gt;I enabled the LTR patch, but now all my module tables (math, io, string, spi and so on) are read only. Do I have to
+  disable LTR if I want write access to these modules?&lt;/a&gt;
 &lt;/ul&gt;
 &lt;hr&gt;
 
@@ -123,7 +125,7 @@
 &lt;p&gt;There are a number of things you can try to overcome this:&lt;/p&gt;
 &lt;ul&gt;
   &lt;li&gt;&lt;b&gt;enable the LTR patch&lt;/b&gt;: you can get very significant improvements if you enable the LTR patch in your &lt;b&gt;eLua&lt;/b&gt; image. See 
-  &lt;a href=&quot;&quot;&gt;##here&lt;/a&gt; for more details about LTR, and &lt;a href=&quot;building.html&quot;&gt;here&lt;/a&gt; for instructions about enabling LTR.&lt;/li&gt;
+  &lt;a href=&quot;arch_ltr.html&quot;&gt;here&lt;/a&gt; for more details about LTR, and &lt;a href=&quot;building.html&quot;&gt;here&lt;/a&gt; for instructions about enabling LTR.&lt;/li&gt;
   &lt;li&gt;&lt;b&gt;precompile your source to bytecode&lt;/b&gt;: if you use bytecode instead of source code Lua won't need to compile your source, so you save some RAM.&lt;/li&gt;
   &lt;li&gt;&lt;b&gt;try to avoid using too many strings&lt;/b&gt;: strings are immutable in Lua. That means that a statement like &lt;i&gt;s = s .. &quot;\n&quot;&lt;/i&gt; (where s is a string) 
   will create a new string each time it's called. If this happens a lot (for example in a loop), your memory will quickly run out because of all the
@@ -132,4 +134,17 @@
   &lt;li&gt;&lt;b&gt;control Lua's garbage collection manually&lt;/b&gt;: if you're still running out of memory, try calling &lt;i&gt;collectgarbage('collect')&lt;/i&gt; from your code, 
   which will force a garbage collection and thus might free some memory.&lt;/li&gt;
 &lt;/ul&gt;
+
+&lt;a name=&quot;rotables&quot;&gt;&lt;h2&gt;I enabled the LTR patch, but now all my module tables (math, io, string, spi and so on) are read only. Do I have to
+  disable LTR if I want write access to these modules?&lt;/h2&gt;&lt;/a&gt;
+&lt;p&gt;You don't really have to disable LTR to get write access to your rotables, you can use some simple Lua &quot;tricks&quot; instead. Let's suppose that you need
+  write access to the &lt;b&gt;math&lt;/b&gt; module. With LTR enabled, &lt;b&gt;math&lt;/b&gt; is a rotable, so you can't change its keys/values. But you can use metatables
+  to overcome this limitation:&lt;/p&gt;
+&lt;p&gt;&lt;pre&gt;&lt;code&gt;local oldmath = math
+math = { __index = oldmath }
+setmetatable( math, math )
+&lt;/code&gt;&lt;/pre&gt;&lt;/p&gt;
+&lt;p&gt;This way you can use &lt;i&gt;math&lt;/i&gt; in &quot;write mode&quot; now (since it is a regular table), but you can still access the keys from the original &lt;i&gt;math&lt;/i&gt;
+  rotable. Of course, if you need write access to &lt;b&gt;all&lt;/b&gt; your modules (or to most of them) it makes more sense to disable LTR instead, but from our 
+  observations this doesn't happen in practice.&lt;/p&gt;
 &lt;/body&gt;&lt;/html&gt;

Modified: trunk/doc/en/status.html
===================================================================
--- trunk/doc/en/status.html	2009-03-10 20:39:51 UTC (rev 251)
+++ trunk/doc/en/status.html	2009-03-11 13:58:20 UTC (rev 252)
@@ -495,7 +495,7 @@
 &lt;td style=&quot;text-align: center;&quot;&gt;&lt;img src=&quot;../wb_img/stat_not_implemented.png&quot;&gt;&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
-&lt;td style=&quot;text-align: left;&quot;&gt;eLua LTR (Lua Tiny RAM) patch &nbsp;##a link to a small description...&lt;/td&gt;
+&lt;td style=&quot;text-align: left;&quot;&gt;&lt;a href=&quot;arch_ltr.html&quot;&gt;eLua LTR (Lua Tiny RAM) patch&lt;/a&gt;&lt;/td&gt;
 &lt;td style=&quot;text-align: center;&quot;&gt;&lt;img src=&quot;../wb_img/stat_ok.png&quot;&gt;&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000207.html">[Elua-svn] r251 - in trunk: inc/newlib src src/newlib	src/platform/i386 src/platform/lm3s
</A></li>
	<LI>Next message: <A HREF="000209.html">[Elua-svn] r253 - trunk/doc/en
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#208">[ date ]</a>
              <a href="thread.html#208">[ thread ]</a>
              <a href="subject.html#208">[ subject ]</a>
              <a href="author.html#208">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/elua-svn">More information about the eLua-svn
mailing list</a><br>
</body></html>
